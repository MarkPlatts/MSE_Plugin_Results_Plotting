{
    "collab_server" : "",
    "contents" : "rm(list = ls())\n\nlibrary(reshape)\n#library(dplyr)\n#library(plyr)\nlibrary(data.table)\n\nsource(\"C:/Users/Mark/Desktop/MSE_Plugin_Results_Plotting/share_tools.R\")\n\n### Generate tables for the risk-reward plots\n#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\ncreate_riskreward_table <- function(){\n  \n  plot.path = \"C://Users/Mark/Dropbox/GAP2_MSE Plugin2/North Sea MultiAnnual Plan/withBiomassForcing_Yearly_Results HCR type1 and 3/Plots/\"\n  RootPath =  \"C://Users/Mark/Dropbox/GAP2_MSE Plugin2/North Sea MultiAnnual Plan/withBiomassForcing_Yearly_Results HCR type1 and 3/Results\"\n  \n  #get a list of all the files in the Biomass folder\n  g.biomass <- list.files(paste(RootPath,\"\\\\Biomass\", sep=''), full.names=TRUE)\n  g.catch <- list.files(paste(RootPath,\"\\\\CatchTrajectories\", sep=''), full.names=TRUE)\n  \n  total = data.table()\n  \n  for(G.biomass in g.biomass){\n    \n    #Get the filename to be used to check whether yearly in name, to name files of plots and to add text to plots\n    FILENAME = substr(G.biomass,1,nchar(G.biomass)-4)\n    \n    #dat <- read.csv(G.biomass,skip=7, head=T)\n    dat <- fread(G.biomass,skip=7, head=T)\n    #names(dat) = c(names(dat)[1:4],1:43)\n    \n    dat <- melt(dat, id=c(\"GroupName\",\"ModelID\",\"StrategyName\",\"ResultType\"))\n    dat$variable = as.numeric(dat$variable)\n    GroupName = dat[1,GroupName]\n    \n    # unique_strats = unique(dat$StrategyName)\n    # unique_ModelID = unique(dat$ModelID)\n    \n    dat = filter(dat, variable>=39)\n    #print(ddply(dat, .(GroupName,ModelID,StrategyName,ResultType),summarise, mean_val = mean(value)))\n    dat_biomass = ddply(dat, .(GroupName,ModelID,StrategyName),summarise, Biomass5YearMean = mean(value))\n\n    #Find the matching catch trajectory\n    for(G.catch in g.catch){\n      if (length(grep(GroupName, G.catch, fixed=TRUE))==1){\n        if (length(grep(\"AllFleets\", G.catch, fixed=TRUE))==1){\n\n          dat <- fread(G.catch,skip=7, head=T)\n          #names(dat) = c(names(dat)[1:5],1:20)\n          \n          dat <- melt(dat, id=c(\"GroupName\",\"FleetName\",\"ModelID\",\"StrategyName\",\"ResultType\"))\n          dat$variable = as.numeric(dat$variable)\n          \n          # unique_strats = unique(dat$StrategyName)\n          # unique_ModelID = unique(dat$ModelID)\n          \n          dat = filter(dat, variable>=16)\n          dat_catch = ddply(dat, .(GroupName,ModelID,StrategyName),summarise, Catch5YearMean = mean(value))\n          break\n        }\n      }\n    }\n    \n    both <- merge(dat_biomass,dat_catch,by=c(\"ModelID\",\"GroupName\",\"StrategyName\"), sort=FALSE) \n\n    total <- rbind(total,both)\n    \n    #browser()\n    #Save this to risk_reward_tables\n    #write.csv(both,paste(plot.path,\"RISK_REWARD_TABLES/\",GroupName,\".csv\",sep=\"\"))\n  }\n  \n  write.csv(total,paste(plot.path,\"RISK_REWARD_TABLES/Total.csv\",sep=\"\"))\n  \n}",
    "created" : 1480349803680.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4196095641",
    "id" : "D5F118DA",
    "lastKnownWriteTime" : 1480599853,
    "last_content_update" : 1480599853541,
    "path" : "C:/Users/Mark/Desktop/MSE_Plugin_Results_Plotting/riskrewardtable.R",
    "project_path" : "riskrewardtable.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}