{
    "collab_server" : "",
    "contents" : "library(dplyr)\nlibrary(reshape)\nlibrary(ggplot2)\n\nsetwd(\"C:/Users/Mark/Desktop/MSE_Plugin_Results_Plotting/\")\nsource(\"share_tools.R\")\n\n\n#Loads the file in folder specified containing all the strings in vector of strings\nLoadFile_ContainsListStrings = function(Dir.Path, StringsInFileName)\n{\n  #Get a list of all the files\n  AllFiles <- list.files(Dir.Path)\n  #Need to loop across all files so that we can extract\n  for (iFile in AllFiles){\n    #Find and load file that contains values for selected group and fleet\n    FoundFile = StringContains_AllStrings(ContainingString=iFile, MultipleStrings2Check=StringsInFileName)\n    if(FoundFile) {\n      iFile.data <- read.csv(paste(Dir.Path,iFile, sep=''),skip=7, head=T)\n      return (iFile.data)\n    }\n  }\n  return(NA)\n  \n}\n\n\nAverage_Quota_Across_Models_And_RegTypes = function(Group, Fleet, RegulationType, ResultsPath)\n{\n\n  FileData = LoadFile_ContainsListStrings(Dir.Path = paste(ResultsPath,\"/HCRQuota_Targ/\",sep=''), StringsInFileName = c(Group, Fleet))\n  \n  UniqueStrategies = LoadUniqueStrategies(ResultsPath)\n  \n  Strategies_OfRegType = SubsetVectorStrings_ContainingString(UniqueStrategies, RegulationType)\n\n  FileData = filter(FileData, StrategyName %in% Strategies_OfRegType)\n  \n  return(as.numeric(colMeans(FileData[,6:ncol(FileData)])))\n\n}\n\nPlot_Average_Quotas = function(results.path, plot.path, Groups, Fleets, TimeSteps, RegulationTypes)\n{\n  Area_km2 = 570000\n  #Get all the groups to plot\n  #UniqueGroups = LoadUniqueGroups(Path)\n  for(iFleet in Fleets)\n  {\n  \n    df_Average_Quota = data.frame()\n    \n    #Cycle across all groups to plot and extract the results putting them in a dataframe\n    for(iGroup in Groups)\n    {\n      print(paste(\"Group =\", iGroup, \"Fleet =\",iFleet))\n      for(iRegulation in RegulationTypes)\n      {\n        temp_mean_vals = Average_Quota_Across_Models_And_RegTypes(iGroup,iFleet,iRegulation,results.path)\n        temp_mean_vals = temp_mean_vals * Area_km2\n        df_Average_Quota = rbind(df_Average_Quota, data.frame(TimeSteps = TimeSteps, GroupName = iGroup, Regulation = iRegulation, AverageQuota = temp_mean_vals))\n      }\n    }\n  \n    #use ggplot to plot results - specify legends to be species and a column of different regulation types  \n    #browser()\n    #png(filename = paste(plot.path,\"/AVERAGE_REGS/\",iFleet,\".png\",sep=\"\"), res=900, width=8, height=12, units='in')\n    df_Average_Quota[]\n    Plot2Save = qplot(TimeSteps, AverageQuota, data=df_Average_Quota, geom=c(\"line\"), color=GroupName, facets=Regulation~., main=iFleet)\n    \n    ggsave(Plot2Save, file=paste(plot.path,\"/AverageQuota_EachFleet/AverageQuota_\",iFleet,\".png\",sep=\"\"), width=6, height=12, limitsize = FALSE)\n    \n  }\n  \n}\n\n\n",
    "created" : 1486141524636.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3464221145",
    "id" : "B39811",
    "lastKnownWriteTime" : 1486192238,
    "last_content_update" : 1486192238617,
    "path" : "C:/Users/Mark/Desktop/MSE_Plugin_Results_Plotting/Calc_average_quota_per_fleet_group_regulation.R",
    "project_path" : "Calc_average_quota_per_fleet_group_regulation.R",
    "properties" : {
    },
    "relative_order" : 8,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}